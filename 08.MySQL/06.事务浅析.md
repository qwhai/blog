## MySQL事务浅析

### 何为事务

### 事务四大特征(ACID)

### 事务能做什么

### 基于Shell的事务

首先查询一下当前数据库中的数据：

```sql
SELECT * FROM teacher;
```

```
+----+---------+----------+-----+-----+---------------------+
| id | sn      | name     | sex | age | ctime               |
+----+---------+----------+-----+-----+---------------------+
|  1 | 1000001 | Charles  |   0 |  48 | 2016-07-19 16:01:56 |
|  2 | 1000002 | Jose     |   1 |  38 | 2002-03-28 01:36:27 |
... ...
| 10 | 1000010 | Connor   |   1 |  37 | 2012-01-04 23:54:40 |
| 11 | 1000011 | Chase    |   0 |  48 | 2001-06-01 00:59:57 |
+----+---------+----------+-----+-----+---------------------+
```

然后进行事务操作。事务操作的开始需要使用`BEGIN;`标识。如下：

```sql
BEGIN;
INSERT INTO teacher (sn, name, sex, age, ctime) VALUES (1000012, 'Bob1', 1, 29, '2012-01-04 23:54:41');
INSERT INTO teacher (sn, name, sex, age, ctime) VALUES (1000013, 'Bob2', 1, 29, '2012-01-04 23:54:41');
```

这样再查询一下可以看到数据增加了

```
+----+---------+----------+-----+-----+---------------------+
| id | sn      | name     | sex | age | ctime               |
+----+---------+----------+-----+-----+---------------------+
|  1 | 1000001 | Charles  |   0 |  48 | 2016-07-19 16:01:56 |
|  2 | 1000002 | Jose     |   1 |  38 | 2002-03-28 01:36:27 |
... ...
| 10 | 1000010 | Connor   |   1 |  37 | 2012-01-04 23:54:40 |
| 11 | 1000011 | Chase    |   0 |  48 | 2001-06-01 00:59:57 |
| 12 | 1000012 | Bob1     |   1 |  29 | 2012-01-04 23:54:41 |
| 13 | 1000013 | Bob2     |   1 |  29 | 2012-01-04 23:54:41 |
+----+---------+----------+-----+-----+---------------------+
```

然后使用回滚。回滚后之前插入的数据会被清理掉。

```sql
ROLLBACK;
```

现在，我们再来查询一次所有的数据：

```
+----+---------+----------+-----+-----+---------------------+
| id | sn      | name     | sex | age | ctime               |
+----+---------+----------+-----+-----+---------------------+
|  1 | 1000001 | Charles  |   0 |  48 | 2016-07-19 16:01:56 |
|  2 | 1000002 | Jose     |   1 |  38 | 2002-03-28 01:36:27 |
... ...
| 10 | 1000010 | Connor   |   1 |  37 | 2012-01-04 23:54:40 |
| 11 | 1000011 | Chase    |   0 |  48 | 2001-06-01 00:59:57 |
+----+---------+----------+-----+-----+---------------------+
```

### 在Java程序中集成事务

### Ref

- [https://www.runoob.com/mysql/mysql-transaction.html](https://www.runoob.com/mysql/mysql-transaction.html)

- [https://draveness.me/mysql-transaction](https://draveness.me/mysql-transaction)
- [https://www.jianshu.com/p/0d0981f4be62](https://www.jianshu.com/p/0d0981f4be62)
- [https://www.jianshu.com/p/ebd63b2f3ba4](https://www.jianshu.com/p/ebd63b2f3ba4)

------------

日期：2019年06月28日

------------

- [Github](https://github.com/qwhai)
- [Blog<sup>csdn</sup>](https://qwhai.blog.csdn.net)
- [E-mail](return_zero0@163.com)
